# Set up physical hosts and everything that doesn't depend on any local services

- name: Set up Proxmox VE
  hosts: proxmox1
  become: true
  tasks:
    - import_role:
        name: proxmox
    - import_role:
        name: net-ingress
        tasks_from: proxmox_config.yml

- name: Set up Ingress instance
  hosts: net-ingress
  become: true
  tasks:
    - import_role:
        name: base
    - import_role:
        name: net-ingress

- name: Set up PostgreSQL server
  hosts: db-postgres
  become: true
  tasks:
    - import_role:
        name: base
    - import_role:
        name: postgresql

- name: Set up storage server
  hosts: storage
  become: true
  tasks:
    - import_role:
        name: base_vm
    - import_role:
        name: base
    - import_role:
        name: storage
