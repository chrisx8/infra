ssl_domain: arb.chrisx.xyz
container_network: ct

container_specs:
  - name: filebrowser
    image: docker.io/filebrowser/filebrowser:latest
    network: "{{ container_network }}"
    cap_add:
      - DAC_OVERRIDE
      - NET_BIND_SERVICE
    volumes:
      - "/opt/filebrowser.db:/database.db:z"
      - "/home:/srv:ro"
    security_opt:
      - label:disable
      - no-new-privileges
  - name: jellyfin
    image: docker.io/jellyfin/jellyfin:latest
    network: "{{ container_network }}"
    volumes:
      - "jellyfin_cache:/cache:Z"
      - "jellyfin_config:/config:Z"
      - "/mnt/media:/media:z"
    user: "nobody:nogroup"
  - name: apache
    image: ghcr.io/chrisx8/apache-openidc:latest
    network: "{{ container_network }}"
    cap_add:
      - CHOWN
      - NET_BIND_SERVICE
    ports:
      - "80:80"
      - "443:443"
      - "8443:8443"
    volumes:
      - "/opt/apache/conf.d:/etc/apache2/sites-enabled:ro,z"
      - "/opt/apache/log:/var/log/apache2:z"
      - "/opt/apache/ssl:/etc/apache2/ssl:ro,z"
      - "/opt/apache/www:/var/www:ro,z"

container_volumes:
  - name: jellyfin_cache
    backup: false
  - name: jellyfin_config
    backup: true
