- name: Install Nginx
  apt:
    name: nginx
    state: latest
- name: Remove built-in Nginx sites (1/3)
  file:
    path: /etc/nginx/sites-available
    state: absent
- name: Remove built-in Nginx sites (2/3)
  file:
    path: /etc/nginx/sites-enabled
    state: absent
- name: Remove built-in Nginx sites (3/3)
  file:
    path: /var/www/html
    state: absent
- name: Install Nginx global configurations (1/2)
  copy:
    src: nginx/_global/nginx.conf
    dest: /etc/nginx/nginx.conf
- name: Install Nginx global configurations (2/2)
  copy:
    src: nginx/_global/conf.d
    dest: /etc/nginx/
    directory_mode: true
- name: Install Nginx configurations
  copy:
    src: nginx/access-gateway/conf.d
    dest: /etc/nginx/
    directory_mode: true
- name: Reload Nginx
  systemd:
    name: nginx
    state: reloaded
