- name: Create containers directory
  file:
    path: ~/containers
    state: directory
    mode: 0700
- name: Create Nginx logs directory
  file:
    path: ~/log/nginx
    state: directory
    mode: 0700

- name: Create vaultwarden data directory
  file:
    path: /opt/vaultwarden-data
    state: directory
    owner: nobody
    group: nogroup

- name: Install docker-compose.yml
  copy:
    src: docker-compose.yml
    dest: ~/containers/docker-compose.yml
    mode: 0644

- name: Start containers (docker-compose)
  command:
    chdir: ~/containers
    cmd: "docker compose up -d --build --remove-orphans"
