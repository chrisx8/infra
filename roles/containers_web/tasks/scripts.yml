---
- name: Configure crontab
  ansible.builtin.cron:
    name: MAILTO
    env: true
    job: ""

- name: Copy backup script
  ansible.builtin.template:
    src: backup.sh
    dest: "{{ _container_user_info.home }}/backup.sh"
    mode: "0750"
- name: Set up backup cron job
  ansible.builtin.cron:
    name: container backup
    job: "{{ _container_user_info.home }}/backup.sh"
    hour: 22
    minute: 12
    state: present

- name: Copy logrotate config
  ansible.builtin.template:
    src: logrotate.conf
    dest: "{{ _container_user_info.home }}/apache/logrotate.conf"
    mode: "0640"
- name: Set up logrotate cron job
  ansible.builtin.cron:
    name: apache logrotate
    # yamllint disable-line rule:line-length
    job: /usr/sbin/logrotate -s {{ _container_user_info.home }}/apache/logrotate.state {{ _container_user_info.home }}/apache/logrotate.conf
    hour: 2
    minute: 0
    state: present
