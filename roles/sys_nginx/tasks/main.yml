- name: Install Nginx
  apt:
    name: nginx
    state: latest

- name: Remove built-in Nginx sites (1/3)
  file:
    path: /etc/nginx/sites-available
    state: absent
- name: Remove built-in Nginx sites (2/3)
  file:
    path: /etc/nginx/sites-enabled
    state: absent
- name: Remove built-in Nginx sites (3/3)
  file:
    path: /var/www/html/index.nginx-debian.html
    state: absent

- name: Install Nginx global configurations (1/2)
  copy:
    src: nginx/_global/nginx.conf
    dest: /etc/nginx/nginx.conf
- name: Install Nginx global configurations (2/2)
  copy:
    src: nginx/_global/conf.d
    dest: /etc/nginx/
    directory_mode: true

- name: Configure cron job (Reload Nginx daily)
  cron:
    name: "Reload Nginx daily"
    minute: "2"
    hour: "7"
    job: "nginx -s reload"
