---
- name: Verify requirements
  ansible.builtin.assert:
    that:
      - ansible_facts.distribution_major_version|int >= 8
      - ansible_facts.os_family == 'RedHat'
      - ansible_facts.virtualization_type != 'lxc'
      - cx_container_runtime_port_start > 0

- name: Install Podman
  ansible.builtin.dnf:
    name: podman
    state: present

- name: Allow unprivileged port bind
  ansible.posix.sysctl:
    name: net.ipv4.ip_unprivileged_port_start
    value: "{{ cx_container_runtime_port_start }}"
    reload: true
    state: present
