<VirtualHost *:443>
    ServerName sso.chrisx.xyz

    SSLEngine on
    SSLCertificateFile /etc/httpd/ssl/{{ _apache_cert_name }}/fullchain.pem
    SSLCertificateKeyFile /etc/httpd/ssl/{{ _apache_cert_name }}/privkey.pem

    Header unset Strict-Transport-Security
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

    ProxyPass / http://keycloak:8080/ nocanon
    ProxyPassReverse / http://keycloak:8080/ nocanon
    ProxyPreserveHost On
    RequestHeader set X-Forwarded-Proto expr=%{REQUEST_SCHEME}

    ErrorLog /var/log/httpd/sso_error.log
    CustomLog /var/log/httpd/sso_access.log combined
</VirtualHost>
