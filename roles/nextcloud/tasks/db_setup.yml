- name: Generate new password for MySQL nextcloud user
  set_fact:
    mysql_nextcloud_password: "{{ lookup('password', '/dev/null length=64') }}"
  changed_when: no
- name: Create Nextcloud database
  mysql_db:
    name: nextcloud
    state: present
- name: Create MySQL nextcloud user
  mysql_user:
    name: nextcloud
    host: localhost
    password: "{{ mysql_nextcloud_password }}"
    priv:
      'nextcloud.*': 'ALL'
    state: present
