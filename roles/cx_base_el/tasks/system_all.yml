---
- name: Set hostname
  ansible.builtin.hostname:
    name: "{{ ansible_host }}"
    use: systemd

- name: Set timezone
  community.general.timezone:
    name: "{{ timezone }}"
    hwclock: UTC
  when: timezone is defined

- name: Disable systemd coredump
  ansible.builtin.lineinfile:
    dest: /etc/systemd/coredump.conf
    regex: Storage=
    line: Storage=none

- name: Limit systemd-journald
  ansible.builtin.lineinfile:
    dest: /etc/systemd/journald.conf
    regex: SystemMaxUse=
    line: SystemMaxUse=10M

- name: Set default text editor to vim
  ansible.builtin.lineinfile:
    dest: /etc/environment
    regex: ^EDITOR=
    line: EDITOR=vim
- name: Configure vim
  ansible.builtin.copy:
    src: vimrc
    dest: /etc/vimrc.local
    mode: "0644"

- name: Configure crontab
  ansible.builtin.cron:
    name: MAILTO
    env: true
    job: ""
