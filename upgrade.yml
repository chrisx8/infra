---
# - name: Upgrade Proxmox VE hosts
#   hosts: hosts_pve
#   become: true
#   tasks:
#     - name: Upgrade
#       ansible.builtin.import_role:
#         name: cx_base_pve
#         tasks_from: upgrade.yml
#     - name: Install ssl cert for PVE
#       ansible.builtin.import_role:
#         name: cx_base_pve
#         tasks_from: ssl_cert.yml

- name: Upgrade EL hosts
  hosts: hosts_el
  become: true
  tasks:
    - name: Upgrade
      ansible.builtin.import_role:
        name: cx_base_el
        tasks_from: upgrade.yml

- name: Upgrade Cockpit
  hosts: cx_cockpit_kvm
  become: true
  tasks:
    - name: Install ssl cert for Cockpit
      ansible.builtin.import_role:
        name: cx_cockpit_kvm
        tasks_from: sslcert.yml

- name: Upgrade PostgreSQL
  hosts: cx_postgresql
  become: true
  tasks:
    - name: Install ssl cert for PostgreSQL
      ansible.builtin.import_role:
        name: cx_postgresql
        tasks_from: sslcert.yml

- name: Set up container apps
  hosts: cx_container_app
  gather_facts: true
  gather_subset:
    - "!min"
    - distribution
    - virtualization_type
  roles:
    - cx_container_app
