# Set up web applications

- name: Set up Postgres databases
  hosts: db-postgres
  gather_facts: false
  become: true
  become_user: postgres
  tasks:
    - import_role:
        name: containers
        tasks_from: create_postgres_db.yml
    - import_role:
        name: firefly-iii
        tasks_from: create_postgres_db.yml
    - import_role:
        name: nextcloud
        tasks_from: create_postgres_db.yml

- name: Set up containers
  hosts: web-docker
  become: true
  tasks:
    - import_role:
        name: base_vm
    - import_role:
        name: base
    - import_role:
        name: containers

- name: Set up Apache + PHP
  hosts: web-php
  become: true
  tasks:
    - import_role:
        name: base
    - import_role:
        name: apache_php
    - import_role:
        name: firefly-iii
    - import_role:
        name: nextcloud
    - import_role:
        name: launcher
