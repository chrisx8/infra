---
ansible_host: v-containers.arb.chrisx.xyz

cx_container_app_postgres_db: vaultwarden

# Vaultwarden: HTTP + WebSocket on 127.0.0.1:8288
cx_container_app_spec:
  name: vaultwarden
  image: docker.io/vaultwarden/server:testing
  network: host
  env:
    _ENABLE_DUO: "false"
    _ENABLE_EMAIL_2FA: "false"
    # yamllint disable-line rule:line-length
    DATABASE_URL: postgres://{{ cx_container_app_postgres_db }}:{{ _postgres_password }}@127.0.0.1:5432/{{ cx_container_app_postgres_db }}?sslmode=disable
    DISABLE_ADMIN_TOKEN: "true"
    DOMAIN: https://vaultwarden.arb.chrisx.xyz
    EVENTS_DAYS_RETAIN: "30"
    IP_HEADER: X-Forwarded-For
    ORG_EVENTS_ENABLED: "true"
    PASSWORD_HINTS_ALLOWED: "false"
    PASSWORD_ITERATIONS: "600000"
    PUSH_ENABLED: "true"
    PUSH_INSTALLATION_ID: "{{ _vaultwarden_push_installation_id }}"
    PUSH_INSTALLATION_KEY: "{{ _vaultwarden_push_installation_key }}"
    ROCKET_ADDRESS: 127.0.0.1
    ROCKET_PORT: "8288"
    SIGNUPS_ALLOWED: "false"
    SIGNUPS_VERIFY: "true"
    SIGNUPS_VERIFY_RESEND_LIMIT: "3"
    SMTP_FROM: "{{ _vaultwarden_smtp_from }}"
    SMTP_HOST: "{{ _vaultwarden_smtp_host }}"
    SMTP_PORT: "{{ _vaultwarden_smtp_port }}"
    SMTP_USERNAME: "{{ _vaultwarden_smtp_username }}"
    SMTP_PASSWORD: "{{ _vaultwarden_smtp_password }}"
    SMTP_SECURITY: force_tls
    YUBICO_CLIENT_ID: "{{ _vaultwarden_yubico_client_id }}"
    YUBICO_SECRET_KEY: "{{ _vaultwarden_yubico_secret_key }}"
  volumes:
    - vaultwarden:/data:Z

cx_container_app_volumes:
  - vaultwarden
