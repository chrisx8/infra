---
- name: Set up Postgres nextcloud database
  hosts: db-postgres
  gather_facts: no
  become: yes
  become_user: postgres
  tasks:
  - import_role:
      name: firefly-iii
      tasks_from: create_postgres_db.yml
  - import_role:
      name: kanboard
      tasks_from: create_postgres_db.yml
  - import_role:
      name: nextcloud
      tasks_from: create_postgres_db.yml
- name: Set up LAMP hosts
  hosts: lamp
  become: yes
  vars_prompt:
    - name: ha_client_secret
      prompt: "home-assistant.chrisx.xyz - OIDC Client Secret"
    - name: webapps_client_secret
      prompt: "webapps.chrisx.xyz - OIDC Client Secret"
  tasks:
  - import_role:
      name: base
  - import_role:
      name: lamp_stack
  - import_role:
      name: firefly-iii
  - import_role:
      name: nextcloud
  - import_role:
      name: dashboard
  - name: Reboot
    reboot:
