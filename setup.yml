---
# - name: Set up Proxmox VE hosts
#   hosts: hosts_pve
#   become: true
#   gather_facts: true
#   gather_subset:
#     - "!min"
#     - distribution
#     - virtualization_role
#     - virtualization_type
#   vars_prompt:
#     - name: cx_tailscale_auth_key
#       prompt: |-
#         ###### Tailscale - ACTION REQUIRED ######
#         Generate a pre-authorized Tailscale auth key at https://login.tailscale.com/admin/settings/keys
#         Enter Tailscale auth key
#   roles:
#     - cx_base_pve
#     - cx_tailscale

- name: Set up EL hosts
  hosts: hosts_el
  become: true
  gather_facts: true
  gather_subset:
    - "!min"
    - distribution
    - virtualization_type
  vars_prompt:
    - name: cx_tailscale_auth_key
      prompt: |-
        ###### Tailscale - ACTION REQUIRED ######
        Generate a pre-authorized Tailscale auth key at https://login.tailscale.com/admin/settings/keys
        Enter Tailscale auth key
  roles:
    - cx_base_el
    - cx_container_runtime
    - cx_tailscale

- name: Set up Cockpit + KVM
  hosts: cx_cockpit_kvm
  become: true
  gather_facts: true
  gather_subset:
    - "!min"
    - distribution
    - virtualization_type
  roles:
    - cx_cockpit_kvm

- name: Set up PostgreSQL
  hosts: cx_postgresql
  become: true
  gather_facts: true
  gather_subset:
    - "!min"
    - distribution
  roles:
    - cx_postgresql

- name: Set up storage server
  hosts: storage
  become: true
  gather_facts: true
  gather_subset:
    - "!min"
    - distribution
  roles:
    - cx_samba

- name: Set up container apps
  hosts: cx_container_app
  gather_facts: true
  gather_subset:
    - "!min"
    - distribution
    - virtualization_type
  roles:
    - cx_container_app
