---
- name: Set up webhosts
  hosts: webhosts
  become: true
  vars:
  vars_prompt:
  tasks:
  - name: Basic setup
    import_role:
      name: sys_basic
  - name: Install Nginx
    import_role:
      name: sys_nginx
  - name: Install PHP + MySQL
    import_role:
      name: sys_php_mysql
  - name: Install Nginx config
    copy:
      src: nginx/webhosts/conf.d/
      dest: /etc/nginx/conf.d/
  - name: Install Nginx snippets
    copy:
      src: nginx/webhosts/snippets/
      dest: /etc/nginx/snippets/
  - name: Restart Nginx
    systemd:
      name: nginx
      state: restarted
  - name: Install Dashboard
    import_role:
      name: app_dashboard
  - name: Install BookStack
    import_role:
      name: app_bookstack
  - name: Install FreshRSS
    import_role:
      name: app_freshrss
  - name: Reboot
    reboot:
